"use strict";(self.webpackChunkassistant=self.webpackChunkassistant||[]).push([["reference-picker-lazy"],{1830:(t,e,n)=>{n.d(e,{Z:()=>o});var i=n(7537),s=n.n(i),a=n(3645),r=n.n(a)()(s());r.push([t.id,".display-container[data-v-aef94ed2]{display:flex;flex-direction:column;align-items:center;justify-content:center;height:100%;width:100%;margin-top:24px}.display-container .loading-info[data-v-aef94ed2]{display:flex;flex-direction:column;align-items:center;justify-content:center;margin-top:12px;margin-bottom:24px}.display-container .loading-info .task-scheduled-info[data-v-aef94ed2]{display:flex;flex-direction:column;align-items:center;justify-content:center}.display-container .button-wrapper[data-v-aef94ed2]{display:flex;flex-direction:row;align-items:center;justify-content:center;margin-top:12px;margin-bottom:12px}.display-container .button-wrapper>*[data-v-aef94ed2]{margin-right:12px;margin-left:12px}.display-container .editable-preview[data-v-aef94ed2]{display:flex;flex-direction:column;width:100%;overflow-y:auto;overflow-x:hidden;padding:12px;line-height:1.5;white-space:pre-wrap;word-break:break-word;margin-bottom:24px}","",{version:3,sources:["webpack://./src/components/FreePrompt/FreePromptGenerationDisplay.vue"],names:[],mappings:"AACA,oCACC,YAAA,CACA,qBAAA,CACA,kBAAA,CACA,sBAAA,CACA,WAAA,CACA,UAAA,CACA,eAAA,CAEA,kDACC,YAAA,CACA,qBAAA,CACA,kBAAA,CACA,sBAAA,CACA,eAAA,CACA,kBAAA,CAEA,uEACC,YAAA,CACA,qBAAA,CACA,kBAAA,CACA,sBAAA,CAIF,oDACC,YAAA,CACA,kBAAA,CACA,kBAAA,CACA,sBAAA,CACA,eAAA,CACA,kBAAA,CAEA,sDACC,iBAAA,CACA,gBAAA,CAIF,sDACC,YAAA,CACA,qBAAA,CACA,UAAA,CACA,eAAA,CACA,iBAAA,CACA,YAAA,CACA,eAAA,CACA,oBAAA,CACA,qBAAA,CACA,kBAAA",sourcesContent:["\n.display-container {\n\tdisplay: flex;\n\tflex-direction: column;\n\talign-items: center;\n\tjustify-content: center;\n\theight: 100%;\n\twidth: 100%;\n\tmargin-top: 24px;\n\n\t.loading-info {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\talign-items: center;\n\t\tjustify-content: center;\n\t\tmargin-top: 12px;\n\t\tmargin-bottom: 24px;\n\n\t\t.task-scheduled-info {\n\t\t\tdisplay: flex;\n\t\t\tflex-direction: column;\n\t\t\talign-items: center;\n\t\t\tjustify-content: center;\n\t\t}\n\t}\n\n\t.button-wrapper {\n\t\tdisplay: flex;\n\t\tflex-direction: row;\n\t\talign-items: center;\n\t\tjustify-content: center;\n\t\tmargin-top: 12px;\n\t\tmargin-bottom: 12px;\n\n\t\t>* {\n\t\t\tmargin-right: 12px;\n\t\t\tmargin-left: 12px;\n\t\t}\n\t}\n\n\t.editable-preview {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\twidth: 100%;\n\t\toverflow-y: auto;\n\t\toverflow-x: hidden;\n\t\tpadding: 12px;\n\t\tline-height: 1.5;\n\t\twhite-space: pre-wrap;\n\t\tword-break: break-word;\n\t\tmargin-bottom: 24px;\n\t}\n}\n"],sourceRoot:""}]);const o="textGenerationReference"==n.j?r:null},628:(t,e,n)=>{n.d(e,{Z:()=>o});var i=n(7537),s=n.n(i),a=n(3645),r=n.n(a)()(s());r.push([t.id,".assistant-picker-content-wrapper[data-v-21ed686a]{width:100%}.assistant-picker-content[data-v-21ed686a]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:12px 16px 16px 16px}.assistant-picker-content h2[data-v-21ed686a]{display:flex;align-items:center}.assistant-picker-content .prompts[data-v-21ed686a]{margin-top:8px;display:flex;flex-wrap:wrap;align-items:center}.assistant-picker-content .prompts>*[data-v-21ed686a]{margin-right:8px}.assistant-picker-content .prompt-bubble[data-v-21ed686a]{max-width:250px}.assistant-picker-content .preview[data-v-21ed686a]{width:100%}.assistant-picker-content .spacer[data-v-21ed686a]{flex-grow:1}.assistant-picker-content .attribution[data-v-21ed686a]{color:var(--color-text-maxcontrast);padding-bottom:8px}.assistant-picker-content .input-wrapper[data-v-21ed686a]{display:flex;align-items:center;width:100%}.assistant-picker-content .prompt-select[data-v-21ed686a]{width:100%;margin-top:4px}.assistant-picker-content .footer[data-v-21ed686a]{width:100%;display:flex;align-items:center;justify-content:end;margin-top:12px}.assistant-picker-content .footer>*[data-v-21ed686a]{margin-left:4px}","",{version:3,sources:["webpack://./src/views/FreePrompt/FreePromptCustomPickerElement.vue"],names:[],mappings:"AACA,mDACC,UAAA,CAGD,2CACC,YAAA,CACA,qBAAA,CACA,kBAAA,CACA,sBAAA,CACA,2BAAA,CAEA,8CACC,YAAA,CACA,kBAAA,CAGD,oDACC,cAAA,CACA,YAAA,CACA,cAAA,CACA,kBAAA,CACA,sDACC,gBAAA,CAIF,0DACC,eAAA,CAGD,oDACC,UAAA,CAGD,mDACC,WAAA,CAGD,wDACC,mCAAA,CACA,kBAAA,CAGD,0DACC,YAAA,CACA,kBAAA,CACA,UAAA,CAGD,0DACC,UAAA,CACA,cAAA,CAGD,mDACC,UAAA,CACA,YAAA,CACA,kBAAA,CACA,mBAAA,CACA,eAAA,CACA,qDACC,eAAA",sourcesContent:["\n.assistant-picker-content-wrapper {\n\twidth: 100%;\n}\n\n.assistant-picker-content {\n\tdisplay: flex;\n\tflex-direction: column;\n\talign-items: center;\n\tjustify-content: center;\n\tpadding: 12px 16px 16px 16px;\n\n\th2 {\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t}\n\n\t.prompts {\n\t\tmargin-top: 8px;\n\t\tdisplay: flex;\n\t\tflex-wrap: wrap;\n\t\talign-items: center;\n\t\t> * {\n\t\t\tmargin-right: 8px;\n\t\t}\n\t}\n\n\t.prompt-bubble {\n\t\tmax-width: 250px;\n\t}\n\n\t.preview {\n\t\twidth: 100%;\n\t}\n\n\t.spacer {\n\t\tflex-grow: 1;\n\t}\n\n\t.attribution {\n\t\tcolor: var(--color-text-maxcontrast);\n\t\tpadding-bottom: 8px;\n\t}\n\n\t.input-wrapper {\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\twidth: 100%;\n\t}\n\n\t.prompt-select {\n\t\twidth: 100%;\n\t\tmargin-top: 4px;\n\t}\n\n\t.footer {\n\t\twidth: 100%;\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tjustify-content: end;\n\t\tmargin-top: 12px;\n\t\t> * {\n\t\t\tmargin-left: 4px;\n\t\t}\n\t}\n}\n"],sourceRoot:""}]);const o="textGenerationReference"==n.j?r:null},1411:(t,e,n)=>{n.d(e,{Z:()=>o});var i=n(7537),s=n.n(i),a=n(3645),r=n.n(a)()(s());r.push([t.id,".text2image-picker-content-wrapper[data-v-2d46fd4f]{width:100%}.text2image-picker-content[data-v-2d46fd4f]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:12px 16px 16px 16px}.text2image-picker-content h2[data-v-2d46fd4f]{display:flex;align-items:center}.text2image-picker-content .prompts[data-v-2d46fd4f]{margin-top:8px;display:flex;flex-wrap:wrap;align-items:center}.text2image-picker-content .prompts>*[data-v-2d46fd4f]{margin-right:8px}.text2image-picker-content .prompt-bubble[data-v-2d46fd4f]{max-width:250px}.text2image-picker-content .preview-container[data-v-2d46fd4f]{width:90%}.text2image-picker-content .preview-container .image-preview[data-v-2d46fd4f]{display:flex;flex-direction:column;margin-top:8px;border:3px solid var(--color-border);border-radius:var(--border-radius-large);padding:12px}.text2image-picker-content .spacer[data-v-2d46fd4f]{flex-grow:1}.text2image-picker-content .input-wrapper[data-v-2d46fd4f]{display:flex;align-items:center;width:100%}.text2image-picker-content .prompt-select[data-v-2d46fd4f]{width:100%;margin-top:4px}.text2image-picker-content .footer[data-v-2d46fd4f]{width:100%;display:flex;flex-direction:row;margin-top:12px;justify-content:space-between}.text2image-picker-content .footer .buttons[data-v-2d46fd4f]{display:flex;align-items:end}.text2image-picker-content .footer .buttons>*[data-v-2d46fd4f]{margin-left:4px}.text2image-picker-content .advanced[data-v-2d46fd4f]{width:100%;padding:12px 0}.text2image-picker-content .advanced .line[data-v-2d46fd4f]{display:flex;align-items:center;margin-top:8px}.text2image-picker-content .advanced .line input[data-v-2d46fd4f],.text2image-picker-content .advanced .line select[data-v-2d46fd4f]{margin-left:24px;width:200px}.text2image-picker-content .advanced input[type=number][data-v-2d46fd4f]{width:80px;appearance:initial !important;-moz-appearance:initial !important;-webkit-appearance:initial !important}","",{version:3,sources:["webpack://./src/views/Text2Image/Text2ImageCustomPickerElement.vue"],names:[],mappings:"AACA,oDACC,UAAA,CAGD,4CACC,YAAA,CACA,qBAAA,CACA,kBAAA,CACA,sBAAA,CACA,2BAAA,CAEA,+CACC,YAAA,CACA,kBAAA,CAGD,qDACC,cAAA,CACA,YAAA,CACA,cAAA,CACA,kBAAA,CAEA,uDACC,gBAAA,CAIF,2DACC,eAAA,CAGD,+DACC,SAAA,CAEA,8EACC,YAAA,CACA,qBAAA,CACA,cAAA,CACA,oCAAA,CACA,wCAAA,CACA,YAAA,CAIF,oDACC,WAAA,CAED,2DACC,YAAA,CACA,kBAAA,CACA,UAAA,CAGD,2DACC,UAAA,CACA,cAAA,CAGD,oDACC,UAAA,CACA,YAAA,CACA,kBAAA,CACA,eAAA,CACA,6BAAA,CAEA,6DACC,YAAA,CACA,eAAA,CAEA,+DACC,eAAA,CAKH,sDACC,UAAA,CACA,cAAA,CACA,4DACC,YAAA,CACA,kBAAA,CACA,cAAA,CAEA,qIAEC,gBAAA,CACA,WAAA,CAIF,yEACC,UAAA,CACA,6BAAA,CACA,kCAAA,CACA,qCAAA",sourcesContent:["\n.text2image-picker-content-wrapper {\n\twidth: 100%;\n}\n\n.text2image-picker-content {\n\tdisplay: flex;\n\tflex-direction: column;\n\talign-items: center;\n\tjustify-content: center;\n\tpadding: 12px 16px 16px 16px;\n\n\th2 {\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t}\n\n\t.prompts {\n\t\tmargin-top: 8px;\n\t\tdisplay: flex;\n\t\tflex-wrap: wrap;\n\t\talign-items: center;\n\n\t\t>* {\n\t\t\tmargin-right: 8px;\n\t\t}\n\t}\n\n\t.prompt-bubble {\n\t\tmax-width: 250px;\n\t}\n\n\t.preview-container {\n\t\twidth: 90%;\n\n\t\t.image-preview {\n\t\t\tdisplay: flex;\n\t\t\tflex-direction: column;\n\t\t\tmargin-top: 8px;\n\t\t\tborder: 3px solid var(--color-border);\n\t\t\tborder-radius: var(--border-radius-large);\n\t\t\tpadding: 12px;\n\t\t}\n\t}\n\n\t.spacer {\n\t\tflex-grow: 1;\n\t}\n\t.input-wrapper {\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\twidth: 100%;\n\t}\n\n\t.prompt-select {\n\t\twidth: 100%;\n\t\tmargin-top: 4px;\n\t}\n\n\t.footer {\n\t\twidth: 100%;\n\t\tdisplay: flex;\n\t\tflex-direction: row;\n\t\tmargin-top: 12px;\n\t\tjustify-content: space-between;\n\n\t\t.buttons {\n\t\t\tdisplay: flex;\n\t\t\talign-items: end;\n\n\t\t\t>* {\n\t\t\t\tmargin-left: 4px;\n\t\t\t}\n\t\t}\n\t}\n\n\t.advanced {\n\t\twidth: 100%;\n\t\tpadding: 12px 0;\n\t\t.line {\n\t\t\tdisplay: flex;\n\t\t\talign-items: center;\n\t\t\tmargin-top: 8px;\n\n\t\t\tinput,\n\t\t\tselect {\n\t\t\t\tmargin-left: 24px;\n\t\t\t\twidth: 200px;\n\t\t\t}\n\t\t}\n\n\t\tinput[type=number] {\n\t\t\twidth: 80px;\n\t\t\tappearance: initial !important;\n\t\t\t-moz-appearance: initial !important;\n\t\t\t-webkit-appearance: initial !important;\n\t\t}\n\t}\n}\n"],sourceRoot:""}]);const o="imageGenerationReference"==n.j?r:null},8025:(e,n,i)=>{i.d(n,{default:()=>F});var s=i(4780),a=i(5517),r=i(3567),o=i(9497),l=i(7604),d=i(9368),p=i(4624),c=i(8357),A=i(4706),u=i(6318),m=i(9359),g=i(7845),h=i(9753),C=i(4024),f=i(9695),y=i.n(f),x=i(4705),v=i.n(x);i(144).default.use(v());const w={name:"FreePromptGenerationDisplay",components:{NcLoadingIcon:l.Z,NcRichContenteditable:u.ZP,NcButton:o.Z,NcCheckboxRadioSwitch:m.Z,ContentCopyIcon:c.Z,ClipboardCheckOutlineIcon:A.Z},props:{genId:{type:String,required:!0}},data:()=>({originalResponse:null,originalResult:null,result:null,copied:!1,loading:!0,processing:!1,bgProcessingScheduled:!1,includePrompt:!1,prompt:"",timeUntilCompletion:null,rawCompletionTimestamp:null,closed:!1}),mounted(){this.getResults()},beforeDestroy(){this.closed=!0},methods:{getResults(){if(this.closed)return;const e={params:{genId:this.genId}},n=(0,h.generateUrl)("/apps/assistant/f/get_outputs");return g.default.get(n,e).then((e=>{const n=e.data;if(n.length&&n.length>0){if(!n.length||void 0===n[0]?.status)return this.loading=!1,(0,C.showError)(t("assistant","Unexpected server response")),void this.$emit("error");null===this.rawCompletionTimestamp&&(this.rawCompletionTimestamp=Math.max(...n.map((t=>t.completion_time))),this.updateTimeUntilCompletion(this.rawCompletionTimestamp));const e=n.filter((t=>1===t.status||2===t.status)).length;if(0===e){const e=n.filter((t=>4===t.status||0===t.status)).length;if(e>0){if(e===n.length)return(0,C.showError)(t("assistant","The processing of generations failed.")),this.loading=!1,this.result=null,void this.$emit("error");(0,C.showError)(t("assistant","The processing of some generations failed."))}this.loading=!1,this.$emit("loaded"),this.processCompletion(n)}else e===n.length&&(this.bgProcessingScheduled=!0),this.processing=!0,this.$emit("scheduled"),this.processCompletion(n),setTimeout((()=>{this.getResults()}),1e3)}else this.loading=!1,this.$emit("error"),this.error=e.data.error})).catch((e=>{this.loading=!1,this.$emit("error"),console.error("Text  completions request error",e),(0,C.showError)(t("assistant","Text generation error")+": "+(e.response?.data?.body?.error?.message||e.response?.data?.body?.error?.code||e.response?.data?.error||t("assistant","Unknown text generation API error")))}))},onReset(){this.result=this.originalResult},delayedReset(){this.result=this.result.replace(/\n+$/,""),this.result+=".",setTimeout((()=>{this.onReset()}),0)},async onCopy(){try{const t=this.$refs.output.$el;await this.$copyText(this.result.trim(),t),this.copied=!0,setTimeout((()=>{this.copied=!1}),5e3)}catch(e){console.error(e),(0,C.showError)(t("assistant","Result could not be copied to clipboard"))}},processCompletion(e){this.originalResponse=e;const n=e.length;this.prompt=e[0].prompt;const i=(e=e.filter((t=>3===t.status))).filter((t=>!!t.text)).map((t=>t.text.replace(/^\s+|\s+$/g,"")));if(i.length>0)if(1===n)this.originalResult=this.result=this.includePrompt?t("assistant","Prompt")+"\n"+this.prompt+"\n\n"+t("assistant","Result")+"\n"+i[0]:i[0];else{const e=i.map(((e,n)=>t("assistant","Result {index}",{index:n+1})+"\n"+e));this.originalResult=this.result=this.includePrompt?t("assistant","Prompt")+"\n"+this.prompt+"\n\n"+e.join("\n\n"):e.join("\n\n")}this.$emit("update:result",this.result)},onIncludePromptToggle(){this.processCompletion(this.originalResponse)},onTextEdit(){this.$emit("update:result",this.result)},updateTimeUntilCompletion(t){const e=new Date(1e3*t)-new Date;e<6e4?this.timeUntilCompletion=null:(this.timeUntilCompletion=y()(e,{units:["h","m"],language:OC.getLanguage(),fallbacks:["en"],round:!0}),this.closed||setTimeout((()=>{this.updateTimeUntilCompletion(t)}),3e4))}}};var b=i(3379),k=i.n(b),_=i(7795),I=i.n(_),B=i(569),R=i.n(B),P=i(3565),D=i.n(P),E=i(9216),T=i.n(E),q=i(4589),N=i.n(q),Z=i(1830),U={};U.styleTagTransform=N(),U.setAttributes=D(),U.insert=R().bind(null,"head"),U.domAPI=I(),U.insertStyleElement=T();k()(Z.Z,U);Z.Z&&Z.Z.locals&&Z.Z.locals;var G=i(1900);const S=(0,G.Z)(w,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"display-container"},[null!==t.result&&""!==t.result?e("NcRichContenteditable",{ref:"output",staticClass:"editable-preview",attrs:{id:"free-prompt-output",value:t.result,multiline:!0,disabled:t.loading,placeholder:t.t("assistant","Text generation content"),"link-autocomplete":!1},on:{"update:value":[function(e){t.result=e},t.onTextEdit]}}):t._e(),t._v(" "),t.loading?e("div",[e("NcLoadingIcon",{attrs:{size:64}}),t._v(" "),t.processing?e("div",{staticClass:"loading-info"},[t.bgProcessingScheduled?e("div",{staticClass:"task-scheduled-info"},[t._v("\n\t\t\t\t"+t._s(t.t("assistant","The text generation task was scheduled to run in the background."))+"\n\t\t\t\t"),null!==t.timeUntilCompletion?e("div",[t._v("\n\t\t\t\t\t"+t._s(t.t("assistant","Estimated completion time: ")+t.timeUntilCompletion)+"\n\t\t\t\t")]):e("div",[t._v("\n\t\t\t\t\t"+t._s(t.t("assistant","This can take a while…"))+"\n\t\t\t\t")])]):e("div",[t._v("\n\t\t\t\t"+t._s(t.t("assistant","Some generations are still being processed in the background! Showing finished generations."))+"\n\t\t\t")])]):e("div",[t._v("\n\t\t\t"+t._s(t.t("assistant","Loading generations…"))+"\n\t\t")])],1):t._e(),t._v(" "),t.loading?t._e():e("div",{staticClass:"button-wrapper"},[e("NcButton",{attrs:{disabled:null===t.result||t.loading,type:"secondary",title:t.t("assistant","Copy output text to clipboard")},on:{click:t.onCopy},scopedSlots:t._u([{key:"icon",fn:function(){return[t.copied?e("ClipboardCheckOutlineIcon"):e("ContentCopyIcon")]},proxy:!0}],null,!1,2003204616)},[t._v("\n\t\t\t"+t._s(t.t("assistant","Copy output"))+"\n\t\t\t")]),t._v(" "),e("NcButton",{attrs:{disabled:t.result===t.originalResult||t.loading,type:"secondary",title:t.t("assistant","Reset the output value to the originally generated one")},on:{click:t.delayedReset}},[t._v("\n\t\t\t"+t._s(t.t("assistant","Reset"))+"\n\t\t")]),t._v(" "),e("NcCheckboxRadioSwitch",{attrs:{checked:t.includePrompt,disabled:t.loading||""===t.result},on:{"update:checked":[function(e){t.includePrompt=e},t.onIncludePromptToggle]}},[t._v("\n\t\t\t"+t._s(t.t("assistant","Include prompt in the final result"))+"\n\t\t")])],1)],1)}),[],!1,null,"aef94ed2",null).exports,j={name:"FreePromptCustomPickerElement",components:{NcButton:o.Z,NcLoadingIcon:l.Z,NcTextField:d.Z,ArrowRightIcon:r.Z,NcUserBubble:p.Z,RefreshIcon:a.Z,EyeIcon:s.Z,FreePromptGenerationDisplay:S},props:{providerId:{type:String,required:!0},accessible:{type:Boolean,default:!1}},data:()=>({query:"",genId:null,loading:!1,error:!1,models:[],prompts:null,notify:!1,submitted:!1,result:null,scheduled:!1}),computed:{previewButtonLabel(){return null!==this.result?t("assistant","Regenerate"):t("assistant","Preview")},emptyResult(){return""===this.result.trim()}},watch:{},mounted(){this.focusOnInput(),this.getPromptHistory()},beforeDestroy(){this.notify||this.submitted||this.cancelGeneration()},methods:{focusOnInput(){setTimeout((()=>{this.$refs["assistant-search-input"].$el.getElementsByTagName("input")[0]?.focus()}),300)},getPromptHistory(){const t=(0,h.generateUrl)("/apps/assistant/f/prompt_history");return g.default.get(t,{params:{}}).then((t=>{this.prompts=t.data})).catch((t=>{console.error(t)}))},submit(){this.submitted=!0,this.$emit("submit",this.result.trim())},onError(){this.error=!0,this.loading=!1,this.genId=null},onLoaded(){this.loading=!1},insertPrompt(t){void 0===this.prompts.find((e=>e.value===t))&&this.prompts.unshift({id:0,value:t})},generate(){if(""===this.query)return;this.loading=!0,this.scheduled=!1,this.error=!1,this.result=null,this.genId=null;const e={prompt:this.query},n=(0,h.generateUrl)("/apps/assistant/f/process_prompt");return g.default.post(n,e).then((t=>{const e=t.data;e.length&&e.length>0?(this.genId=e,this.insertPrompt(this.query)):this.error=t.data.error})).catch((e=>{this.loading=!1,console.error("Text  completions request error",e),(0,C.showError)(t("assistant","Text generation error")+": "+(e.response?.data?.body?.error?.message||e.response?.data?.body?.error?.code||e.response?.data?.error||t("assistant","Unknown text generation API error")))}))},cancelGeneration(){if(null===this.genId)return;const e={genId:this.genId},n=(0,h.generateUrl)("/apps/assistant/f/cancel_generation");return g.default.post(n,e).then((t=>{this.genId=null,this.result=null,this.loading=!1})).catch((e=>{console.error("Text  completions request error",e),(0,C.showError)(t("assistant","Text generation error")+": "+(e.response?.data?.body?.error?.message||e.response?.data?.body?.error?.code||e.response?.data?.error||t("assistant","Unknown text generation API error")))}))},notifyWhenReady(){this.notify=!0,this.$emit("submit","")}}};var Y=i(628),$={};$.styleTagTransform=N(),$.setAttributes=D(),$.insert=R().bind(null,"head"),$.domAPI=I(),$.insertStyleElement=T();k()(Y.Z,$);Y.Z&&Y.Z.locals&&Y.Z.locals;const F=(0,G.Z)(j,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"assistant-picker-content-wrapper"},[e("div",{staticClass:"assistant-picker-content"},[e("h2",[t._v("\n\t\t\t"+t._s(t.t("assistant","AI text generation"))+"\n\t\t")]),t._v(" "),e("div",{staticClass:"input-wrapper"},[e("NcTextField",{ref:"assistant-search-input",attrs:{value:t.query,label:t.t("assistant","Enter your question or task here:"),placeholder:"Generate a TODO list for a classic work day.",disabled:t.loading,"show-trailing-button":!!t.query},on:{"update:value":function(e){t.query=e},keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.generate.apply(null,arguments)},"trailing-button-click":function(e){t.query=""}}})],1),t._v(" "),null===t.result||""===t.query?e("div",{staticClass:"prompts"},t._l(t.prompts,(function(n){return e("NcUserBubble",{key:n.id+n.value,staticClass:"prompt-bubble",attrs:{title:n.value,size:30,"avatar-image":"icon-history","display-name":n.value},on:{click:function(e){t.query=n.value}}})})),1):t._e(),t._v(" "),e("div",{staticClass:"preview"},[null!==t.genId?e("FreePromptGenerationDisplay",{attrs:{"gen-id":t.genId,result:t.result},on:{"update:result":function(e){t.result=e},error:t.onError,loaded:t.onLoaded,scheduled:function(e){t.scheduled=!0}}}):t._e()],1),t._v(" "),e("div",{staticClass:"footer"},[e("NcButton",{attrs:{type:"secondary","aria-label":t.t("assistant","Preview text generation by AI"),disabled:t.loading||!t.query},on:{click:t.generate},scopedSlots:t._u([{key:"icon",fn:function(){return[t.loading?e("NcLoadingIcon"):null!==t.result?e("RefreshIcon"):e("EyeIcon")]},proxy:!0}])},[t._v("\n\t\t\t\t"+t._s(t.previewButtonLabel)+"\n\t\t\t\t")]),t._v(" "),null!==t.genId&&t.loading&&t.scheduled?e("NcButton",{attrs:{type:"secondary"},on:{click:t.notifyWhenReady},scopedSlots:t._u([{key:"icon",fn:function(){return[e("ArrowRightIcon")]},proxy:!0}],null,!1,1168934321)},[t._v("\n\t\t\t\t"+t._s(t.t("assistant","Notify when ready"))+"\n\t\t\t\t")]):t._e(),t._v(" "),null!==t.result?e("NcButton",{attrs:{type:"primary","aria-label":t.t("assistant","Submit text generated by AI"),disabled:t.loading||t.emptyResult},on:{click:t.submit},scopedSlots:t._u([{key:"icon",fn:function(){return[e("ArrowRightIcon")]},proxy:!0}],null,!1,1168934321)},[t._v("\n\t\t\t\t"+t._s(t.t("assistant","Submit"))+"\n\t\t\t\t")]):t._e()],1)])])}),[],!1,null,"21ed686a",null).exports},5227:(e,n,i)=>{i.d(n,{default:()=>q});var s=i(4780),a=i(5517),r=i(3567),o=i(9497),l=i(7604),d=i(9368),p=i(9359),c=i(4624),A=i(3139),u=i(8318),m=i(7845),g=i(9753),h=i(4024),C=i(4806);const f={name:"Text2ImageCustomPickerElement",components:{NcButton:o.Z,NcLoadingIcon:l.Z,NcTextField:d.Z,NcCheckboxRadioSwitch:p.Z,ArrowRightIcon:r.Z,NcUserBubble:c.Z,RefreshIcon:a.Z,EyeIcon:s.Z,Text2ImageDisplay:C.Z},props:{providerId:{type:String,required:!0},accessible:{type:Boolean,default:!1}},data:()=>({query:"",result:null,loading:!1,isGenerating:!1,models:[],inputPlaceholder:t("assistant","A description of the image you want to generate"),displayPrompt:!0,notify:!1,prompts:null,submitted:!1,nResults:1,showAdvanced:!1}),computed:{previewButtonLabel(){return null!==this.result?t("assistant","Regenerate"):t("assistant","Preview")},emptyResult(){return null===this.result||0===this.result.length},showAdvancedIcon(){return this.showAdvanced?u.Z:A.Z}},watch:{displayPrompt(t){localStorage.setItem("text2image_display_prompt",JSON.stringify(t))}},mounted(){this.focusOnInput(),this.getPromptHistory();const t="true"===localStorage.getItem("text2image_display_prompt");null!==t&&(this.displayPrompt=t)},beforeDestroy(){this.submitted||this.notify||this.cancelGeneration()},methods:{focusOnInput(){setTimeout((()=>{this.$refs["text2image-search-input"].$el.getElementsByTagName("input")[0]?.focus()}),300)},getPromptHistory(){const t=(0,g.generateUrl)("/apps/assistant/i/prompt_history");return m.default.get(t,{params:{}}).then((t=>{this.prompts=t.data})).catch((t=>{console.error(t)}))},submit(){this.submitted=!0,this.$emit("submit",this.result.reference_url)},insertPrompt(t){void 0===this.prompts.find((e=>e.value===t))&&this.prompts.unshift({id:0,value:t})},cancelGeneration(){if(null===this.result)return;const e=(0,g.generateUrl)("/apps/assistant/i/cancel_generation");m.default.post(e,{imageGenId:this.result.image_gen_id}).catch((e=>{console.error("Image generation cancel request error",e),(0,h.showError)(t("assistant","Image generation cancel error")+": "+(e.response?.data?.body?.error?.message||e.response?.data?.body?.error?.code||e.response?.data?.error||t("assistant","Unknown image generation cancel error")))})),this.result=null},generate(){if(null!==this.result&&this.cancelGeneration(),""===this.query)return;this.loading=!0;const e={prompt:this.query,nResults:this.nResults,displayPrompt:this.displayPrompt},n=(0,g.generateUrl)("/apps/assistant/i/process_prompt");return m.default.post(n,e).then((e=>{const n=e.data;void 0!==n?.url?(this.result=n,this.insertPrompt(this.query)):(0,h.showError)(t("assistant","Unexpected response from server."))})).catch((e=>{console.error("Image generation request error",e),(0,h.showError)(t("assistant","Image generation error")+": "+(e.response?.data?.body?.error?.message||e.response?.data?.body?.error?.code||e.response?.data?.error||t("assistant","Unknown image generation error")))})).then((()=>{this.loading=!1}))},notifyWhenReady(){if(this.failed||null===this.result)return;const e=(0,g.generateUrl)("/apps/assistant/i/notify/"+this.result.image_gen_id);m.default.post(e).then((()=>{(0,h.PV)(t("assistant","You will be notified when the image generation is ready.")),this.notify=!0,this.$emit("submit","")})).catch((e=>{console.error("Notify when ready request error",e),(0,h.showError)(t("assistant","Notify when ready error")+": "+(e.response?.data?.body?.error?.message||e.response?.data?.body?.error?.code||e.response?.data?.error||t("assistant","Unknown notify when ready error")))}))},imageGenerationFailed(){this.isGenerating=!1},imageGenerationReady(){this.isGenerating=!1},imageGenerationIsProcessing(){this.isGenerating=!0}}};var y=i(3379),x=i.n(y),v=i(7795),w=i.n(v),b=i(569),k=i.n(b),_=i(3565),I=i.n(_),B=i(9216),R=i.n(B),P=i(4589),D=i.n(P),E=i(1411),T={};T.styleTagTransform=D(),T.setAttributes=I(),T.insert=k().bind(null,"head"),T.domAPI=w(),T.insertStyleElement=R();x()(E.Z,T);E.Z&&E.Z.locals&&E.Z.locals;const q=(0,i(1900).Z)(f,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"text2image-picker-content-wrapper"},[e("div",{staticClass:"text2image-picker-content"},[e("h2",[t._v("\n\t\t\t"+t._s(t.t("assistant","AI Image Generation"))+"\n\t\t")]),t._v(" "),e("div",{staticClass:"input-wrapper"},[e("NcTextField",{ref:"text2image-search-input",attrs:{value:t.query,label:t.inputPlaceholder,placeholder:"",disabled:t.loading,"show-trailing-button":!!t.query},on:{"update:value":function(e){t.query=e},keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.generate.apply(null,arguments)},"trailing-button-click":function(e){t.query=""}}})],1),t._v(" "),null===t.result||""===t.query?e("div",{staticClass:"prompts"},t._l(t.prompts,(function(n){return e("NcUserBubble",{key:n.id+n.value,staticClass:"prompt-bubble",attrs:{title:n.value,size:30,"avatar-image":"icon-history","display-name":n.value},on:{click:function(e){t.query=n.value}}})})),1):t._e(),t._v(" "),null!==t.result?e("div",{staticClass:"preview-container"},[e("h3",[t._v(t._s(t.t("assistant","Preview")))]),t._v(" "),e("div",{staticClass:"image-preview"},[e("Text2ImageDisplay",{key:t.result.image_gen_id,attrs:{src:t.result.url,prompt:t.result.prompt},on:{failed:t.imageGenerationFailed,ready:t.imageGenerationReady,processing:t.imageGenerationIsProcessing}})],1)]):t._e(),t._v(" "),e("div",{staticClass:"footer"},[e("div",[e("NcButton",{staticClass:"advanced-button",attrs:{type:"tertiary","aria-label":t.t("assistant","Show/hide advanced options")},on:{click:function(e){t.showAdvanced=!t.showAdvanced}},scopedSlots:t._u([{key:"icon",fn:function(){return[e(t.showAdvancedIcon,{tag:"component"})]},proxy:!0}])},[t._v("\n\t\t\t\t\t"+t._s(t.t("assistant","Advanced options"))+"\n\t\t\t\t")])],1),t._v(" "),e("div",{staticClass:"buttons"},[e("NcButton",{attrs:{type:"secondary","aria-label":t.t("assistant","Preview image generation by AI"),disabled:t.loading||!t.query},on:{click:t.generate},scopedSlots:t._u([{key:"icon",fn:function(){return[t.loading?e("NcLoadingIcon"):null!==t.result?e("RefreshIcon"):e("EyeIcon")]},proxy:!0}])},[t._v("\n\t\t\t\t\t"+t._s(t.previewButtonLabel)+"\n\t\t\t\t\t")]),t._v(" "),null!==t.result?e("NcButton",{attrs:{type:"secondary",disabled:!t.isGenerating},on:{click:t.notifyWhenReady},scopedSlots:t._u([{key:"icon",fn:function(){return[e("ArrowRightIcon")]},proxy:!0}],null,!1,1168934321)},[t._v("\n\t\t\t\t\t"+t._s(t.t("assistant","Notify when ready"))+"\n\t\t\t\t\t")]):t._e(),t._v(" "),null!==t.result?e("NcButton",{attrs:{type:"primary","aria-label":t.t("assistant","Submit image(s) generated by AI"),disabled:t.loading||t.emptyResult},on:{click:t.submit},scopedSlots:t._u([{key:"icon",fn:function(){return[e("ArrowRightIcon")]},proxy:!0}],null,!1,1168934321)},[t._v("\n\t\t\t\t\t"+t._s(t.t("assistant","Send"))+"\n\t\t\t\t\t")]):t._e()],1)]),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:t.showAdvanced,expression:"showAdvanced"}],staticClass:"advanced"},[e("div",{staticClass:"line"},[e("NcCheckboxRadioSwitch",{staticClass:"include-query",attrs:{checked:t.displayPrompt},on:{"update:checked":function(e){t.displayPrompt=e}}},[t._v("\n\t\t\t\t\t"+t._s(t.t("assistant","Include the prompt in the result"))+"\n\t\t\t\t")])],1),t._v(" "),e("div",{staticClass:"spacer"}),t._v(" "),e("div",{staticClass:"line"},[e("label",{attrs:{for:"nResults"}},[t._v(t._s(t.t("assistant","Number of results")))]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model",value:t.nResults,expression:"nResults"}],attrs:{id:"nResults",type:"number",min:"1",max:"10"},domProps:{value:t.nResults},on:{input:function(e){e.target.composing||(t.nResults=e.target.value)}}})])])])])}),[],!1,null,"2d46fd4f",null).exports}}]);
//# sourceMappingURL=assistant-reference-picker-lazy.js.map?v=a5fc89b8366b3ca69bec